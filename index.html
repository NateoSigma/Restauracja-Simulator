<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Restauracja Simulator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fff7ec;
      padding: 20px;
      margin: 0;
      display: flex;
    }
    #menu {
      width: 280px;
      background: #fff3e0;
      border-right: 2px solid #ffa726;
      padding: 20px;
      border-radius: 0 10px 10px 0;
      height: 100vh;
      overflow-y: auto;
    }
    #menu h2 {
      margin-top: 0;
      color: #d35400;
    }
    #menu ul {
      list-style: none;
      padding-left: 0;
    }
    #menu li {
      background: #ffe0b2;
      margin: 8px 0;
      padding: 10px;
      border-radius: 8px;
      text-align: left;
      font-size: 14px;
    }
#reviews {
  margin: 15px auto;
  padding: 15px;
  border-radius: 10px;
  border: 2px solid #ffa726;
  background: #fff8e1;
  max-width: 600px;
  font-size: 14px;
  text-align: left;
}

.review {
  background: #ffe0b2;
  margin: 8px 0;
  padding: 10px;
  border-radius: 8px;
  animation: fadeIn 0.5s;
}
.review .stars {
  color: #fbc02d;
  font-size: 16px;
}
#randomIngredientBtn {
  background: #e53935;
  color: #fff;
  font-weight: bold;
  border: none;
  border-radius: 8px;
  padding: 8px 14px;
  cursor: pointer;
}
#randomIngredientBtn:hover {
  background: #c62828;
}
#randomIngredientBtn:disabled {
  background: #888;
  cursor: not-allowed;
}
    #main {
      flex: 1;
      padding: 20px;
    }
    h1 {
      color: #d35400;
    }
    #stats, #upgrades, #dayStats, #log, #customerList {
      margin: 15px auto;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #ffa726;
      background: #fff8e1;
      max-width: 600px;
    }
    button {
      margin: 6px;
      padding: 10px 16px;
      background: #ffa726;
      border: none;
      border-radius: 8px;
      color: #fff;
      cursor: pointer;
    }
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .customer {
      background: #ffe082;
      margin: 8px;
      padding: 10px;
      border-radius: 8px;
      animation: fadeIn 0.5s;
    }
    #cookProgress {
      width: 90%;
      height: 20px;
      background: #ddd;
      border-radius: 10px;
      margin: 10px auto;
      display: none;
    }
    #cookBar {
      height: 100%;
      background: #4caf50;
      width: 0%;
    }
    #log {
      max-height: 150px;
      overflow-y: auto;
      font-size: 14px;
      text-align: left;
    }
    #ingredientsList {
      background: #fff8e1;
      border: 2px solid #ffa726;
      border-radius: 10px;
      max-width: 600px;
      margin: 10px auto;
      padding: 10px;
      font-size: 14px;
      text-align: left;
    }
    #ingredientsList ul {
      list-style: none;
      padding-left: 0;
      margin: 0;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }
    #ingredientsList li {
      background: #ffe0b2;
      padding: 6px 12px;
      border-radius: 6px;
      min-width: 80px;
      text-align: center;
      cursor: pointer;
      user-select: none;
    }
    .column {
            background-color: #222;
            padding: 60px 20px;
            text-align: center;
            border-radius: 15px;
            box-shadow: 5px 5px 15px #000;
            cursor: pointer;
            transition: all 0.3s;
    }
    #ingredientsList li:hover {
      background: #ffc107;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>

<!-- PANEL Z DANAMI -->
<div id="menu">
  <h2>üçΩ Menu</h2>
  <ul id="dishList"></ul>

  <h2>üõí Kup sk≈Çadniki</h2>
  <ul id="buyIngredientsList"></ul>
</div>

<!-- G≈Å√ìWNA CZƒò≈öƒÜ GRY -->
<div id="main">
  <h1>Restauracja Simulator</h1>

  <div id="stats">
    <button id="randomIngredientBtn" onclick="buyRandomIngredient()">üé≤ Losowy sk≈Çadnik (5 z≈Ç)</button>
    <p>üí∞ Got√≥wka: <span id="cash">0</span> z≈Ç</p>
    <p>üì¶ Sk≈Çadniki:</p>
    <div id="ingredientsList"></div>
    <p>üìà Poziom kuchni: <span id="level">1</span></p>

    <!-- Przycisk nagrody -->
    <button id="rewardButton" onclick="claimReward()" style="display:none;">üéÅ Odbierz nagrodƒô!</button>
    <p id="rewardTimer"></p>
  </div>
  
  <div id="upgrades">
    <h3>üîß Ulepszenia</h3>
    <div id="upgradesList"></div>
  </div>

  <button onclick="upgradeKitchen()">Ulepsz kuchniƒô za 250 z≈Ç</button>
  <button id="toggleCustomersBtn" onclick="toggleCustomers()">‚è∏Ô∏è Wstrzymaj klient√≥w</button>
  <button onclick="resetGame()">Resetuj grƒô</button>

  <div id="cookProgress"><div id="cookBar"></div></div>
  
  <div id="customerList"></div>

  <div id="dayStats">
    <p>üìÖ Dzie≈Ñ: <span id="day">1</span></p>
    <p>üßç Podane Dania: <span id="servedToday">0</span></p>
    <p>üí∏ Zysk dzi≈õ: <span id="dailyProfit">0</span> z≈Ç</p>
  </div>
  
  <div id="reviews">
    <h3>üì¢ Opinie klient√≥w</h3>
    <div id="reviewsList"></div>
  </div>

  <div id="log"></div>
</div>

<script>
let state = {
  cash: 200,
  ingredients: {
    banan: 2,
    bu≈Çka: 3,
    camembert: 5,
    chleb: 4,
    cukier: 4,
    cukier_puder: 4,
    cytryna: 3,
    czekolada: 5,
    jab≈Çko: 3,
    jajko: 2,
    kakao: 4,
    l√≥d: 3,
    mas≈Ço: 4,
    mas≈Ço_orzechowe: 7,
    mƒÖka: 5,
    migda≈Çy: 1,
    mleko: 5,
    par√≥wka: 1,
    pomidor: 3,
    ser_feta: 7,
    ser_mozzarella: 4,
    sos_czosnkowy: 4,
    sos_pomidorowy: 4,
    truskawka: 2,
    woda: 2,
    woda_gazowana: 3,
    wo≈Çowina: 8,
    ziemniak: 3
  },
  level: 1,
  day: 1,
  servedToday: 0,
  dailyProfit: 0,
  dailyVisitors: [],
  upgrades: [],
  moneyBonus: 1,
  moneyPenalty: 1,
  customers: []  
};

let rewardInterval = 600000;
let nextRewardTime = 0;
let rewardTimerInterval;
let customersPaused = false;
let customerInterval;
let dayInterval;

const allUpgrades = [
  { name: "‚ö° Szybki klient", effect: "customersFaster", desc: "Klienci przychodzƒÖ o 3% szybciej." },
  { name: "üí∞ Money Money", effect: "moreMoney", desc: "Zyskujesz o 20% wiƒôcej pieniƒôdzy, ale klienci przychodzƒÖ o 5% wolniej." },
  { name: "üè∑Ô∏è Tanio", effect: "cheaperFood", desc: "Zarabiasz o 10% mniej za dania, ale klienci przychodzƒÖ o 7% szybciej." }
];

const customerNames = ["Natalka", "Oskar", "Filip", "Ksawery", "Milena", "Nateo", "Marcel", "Janek", "Oliwia", "Dorian", "Sylwia", "Zuzia", "Julka", "Nikola", "Ewa", "Ola", "Rosti"];

const favoriteOrders = {
  "Natalka": ["SokOwocowy", "Tost"],
  "Oskar": ["Wojanek", "Chipcy"],
  "Filip": ["Pizza"],
  "Ksawery": ["Pizza"],
  "Milena": ["CiastkoCzekoladowe", "HotDog"],
  "Nateo": ["Orzechberd", "Lipton", "Lipton"],
  "Marcel": ["Kebab", "Chipcy"],
  "Janek": ["Kebab", "Chipcy", "Stek"],
  "Oliwia": ["Chipcy", "Chipcy"],
  "Dorian": ["Kebab", "Wojanek"],
  "Julka": ["Makaroniki", "Wojanek", "Nale≈õniki", "Chipcy"],
  "Sylwia": ["Pizza"],
  "Zuzia": ["Jab≈Çecznik", "Burger"],
  "Julka": ["HotDog"],
  "Nikola": ["Chipcy", "Tost"],
  "Ewa": ["Burger"],
  "≈Åukasz": ["Burger", "Cola"],
  "Ola": ["CiastkoCzekoladowe", "ShakeCzekoladowy"],
  "Rosti": ["Tost", "Tost"],
  "Ksawery": ["Kebab", "Tost", "Tost"],
};

const dishes = {
  Burger: {
    ingredients: { mƒÖka: 1, wo≈Çowina: 1, ser_mozzarella: 1 },
    price: 23
  },
  Chipcy: {
    ingredients: { ziemniak: 4 },
    price: 18
  },
  CiastkoCzekoladowe: {
    ingredients: { mƒÖka: 1, jajko: 1, czekolada: 1, cukier: 1, mas≈Ço: 1 },
    price: 22
  },
  Cola: {
    ingredients: { cukier: 1, l√≥d: 1, woda_gazowana: 1 },
    price: 17
  },
  Frytki: {
    ingredients: { ziemniak: 1 },
    price: 7
  },
  GorƒÖcaCzekolada: {
    ingredients: { czekolada: 1, mleko: 1 },
    price: 14
  },
  HotDog: {
    ingredients: { bu≈Çka: 1, par√≥wka: 1, sos_pomidorowy: 1 },
    price: 10
  },
  Jab≈Çecznik: {
    ingredients: { jab≈Çko: 3, mƒÖka: 1, cukier: 1, jajko: 4 },
    price: 28
  },
  Jajecznica: {
    ingredients: { jajko: 3 },
    price: 12
  },
  Kakao: {
    ingredients: { kakao: 1, mleko: 1 },
    price: 12
  },
  Kebab: {
    ingredients: { mƒÖka: 1, wo≈Çowina: 2, sos_czosnkowy: 1 },
    price: 55
  },
  Lipton: {
    ingredients: { woda: 1, cytryna: 1, l√≥d: 2 },
    price: 55
  },
  Makaroniki: {
    ingredients: { cukier_puder: 3, migda≈Çy: 6, jajko: 1 },
    price: 23
  },
  Nale≈õniki: {
    ingredients: { jajko: 5 },
    price: 20
  },
  Orzechberd: {
    ingredients: { bu≈Çka: 1, camembert: 1, mas≈Ço_orzechowe: 1 },
    price: 17
  },
  Pizza: {
    ingredients: { mƒÖka: 1, ser_mozzarella: 1, sos_pomidorowy: 1 },
    price: 45
  },
  Salatka: {
    ingredients: { pomidor: 1, ser_feta: 1, kapusta: 2 },
    price: 20
  },
  ShakeCzekoladowy: {
    ingredients: { mleko: 2, czekolada: 2, l√≥d: 1 },
    price: 35
  },
  SokOwocowy: {
    ingredients: { jab≈Çko: 1, truskawka: 1, banan: 1, woda: 1 },
    price: 13
  },
  Stek: {
    ingredients: { wo≈Çowina: 2 },
    price: 26
  },
  Tost: {
    ingredients: { ser_mozzarella: 1, chleb: 1, sos_pomidorowy: 1 },
    price: 20
  },
  Wojanek: {
    ingredients: { truskawka: 1, woda_gazowana: 1, cukier: 1 },
    price: 12
  },
  ZupaPomidorowa: {
    ingredients: { pomidor: 2, woda: 1 },
    price: 14
  }
};

const ingredientPrices = {
  banan: 2,
  bu≈Çka: 3,
  camembert: 5,
  chleb: 4,
  cukier: 4,
  cukier_puder: 4,
  cytryna: 3,
  czekolada: 5,
  jab≈Çko: 3,
  jajko: 2,
  kakao: 4,
  l√≥d: 3,
  mas≈Ço: 4,
  mas≈Ço_orzechowe: 7,
  mƒÖka: 5,
  migda≈Çy: 1,
  mleko: 5,
  par√≥wka: 1,
  pomidor: 3,
  ser_feta: 7,
  ser_mozzarella: 4,
  sos_czosnkowy: 4,
  sos_pomidorowy: 4,
  truskawka: 2,
  woda: 2,
  woda_gazowana: 3,
  wo≈Çowina: 8,
  ziemniak: 3
};

let isCooking = false;

function buyRandomIngredient() {
  const cost = 5;
  if (state.cash < cost) {
    log("‚ùå Za ma≈Ço got√≥wki na losowy sk≈Çadnik!");
    return;
  }

  state.cash -= cost;

  let ingredients = Object.keys(ingredientPrices);
  let randomIngredient = ingredients[Math.floor(Math.random() * ingredients.length)];

  state.ingredients[randomIngredient] = (state.ingredients[randomIngredient] || 0) + 1;

  log(`üé≤ Kupiono losowy sk≈Çadnik: ${randomIngredient}`);
  updateUI();
}

function toggleCustomers() {
  customersPaused = !customersPaused;
  const btn = document.getElementById("toggleCustomersBtn");

  if (customersPaused) {
    btn.textContent = "‚ñ∂Ô∏è Wzn√≥w klient√≥w i dni";
    clearInterval(customerInterval);
    clearInterval(dayInterval);
    log("‚è∏Ô∏è Wstrzymano klient√≥w i cykl dni.");
  } else {
    btn.textContent = "‚è∏Ô∏è Wstrzymaj klient√≥w i dni";
    customerLoop();
    dayCycle();
    log("‚ñ∂Ô∏è Wznowiono klient√≥w i cykl dni.");
  }
}

function addReview(stars, text) {
  const reviewBox = document.createElement("div");
  reviewBox.className = "review";

  let starsText = "‚≠ê".repeat(stars) + "‚òÜ".repeat(5 - stars);

  reviewBox.innerHTML = `
    <div class="stars">${starsText}</div>
    <div>${text}</div>
  `;

  document.getElementById("reviewsList").prepend(reviewBox);

  setTimeout(() => {
    reviewBox.remove();
  }, 30000);
}

function log(msg) {
  const time = new Date().toLocaleTimeString();
  document.getElementById("log").innerHTML = `[${time}] ${msg}<br>` + document.getElementById("log").innerHTML;
}

function updateUI() {
  document.getElementById("cash").textContent = state.cash;
  document.getElementById("level").textContent = state.level;
  document.getElementById("day").textContent = state.day;
  document.getElementById("servedToday").textContent = state.servedToday;
  document.getElementById("dailyProfit").textContent = state.dailyProfit;

  renderDishList();
  renderIngredientsList();
  renderBuyIngredientsList();
  saveGame();
}

function renderDishList() {
  const list = document.getElementById("dishList");
  list.innerHTML = "";
  for (let dish in dishes) {
    const item = dishes[dish];
    let ingStr = Object.entries(item.ingredients)
      .map(([k, v]) => `${v} ${k}`)
      .join(", ");
    let li = document.createElement("li");
    li.innerHTML = `<strong>${dish}</strong><br>üí∞ ${item.price} z≈Ç<br>üß∫ Wymaga: ${ingStr}`;
    list.appendChild(li);
  }
}

function renderIngredientsList() {
  const container = document.getElementById("ingredientsList");
  container.innerHTML = "<ul></ul>";
  const ul = container.querySelector("ul");
  for (let ing in state.ingredients) {
    const li = document.createElement("li");
    li.textContent = `${ing}: ${state.ingredients[ing]}`;
    ul.appendChild(li);
  }
}

function renderBuyIngredientsList() {
  const list = document.getElementById("buyIngredientsList");
  list.innerHTML = "";
  for (let ing in ingredientPrices) {
    let price = ingredientPrices[ing];
    let li = document.createElement("li");
    li.innerHTML = `${ing} - ${price} z≈Ç <button onclick="buyIngredient('${ing}')">Kup</button>`;
    list.appendChild(li);
  }
}

function buyIngredient(name) {
  const price = ingredientPrices[name];
  if (state.cash >= price) {
    state.cash -= price;
    state.ingredients[name] = (state.ingredients[name] || 0) + 1;
    log(`Kupiono 1x ${name}`);
    updateUI();
  } else {
    log(`Za ma≈Ço got√≥wki na ${name}`);
  }
}

function upgradeKitchen() {
  const cost = 250; // sta≈Ça cena za ulepszenie kuchni
  if (state.cash >= cost) {
    state.cash -= cost;
    state.level += 1;
    log("Ulepszono kuchniƒô do poziomu " + state.level);
    checkForUpgradeUnlock();
    updateUI();
  } else {
    log("Za ma≈Ço got√≥wki na ulepszenie (koszt: " + cost + " z≈Ç).");
  }
}

function checkForUpgradeUnlock() {
  if (state.level % 5 === 0) {
    let upgradeCost = 100 + ((state.level / 5 - 1) * 50); // rosnƒÖcy koszt co 5 lvl
    log(`üéâ Odblokowano nowe ulepszenie! Koszt: ${upgradeCost} z≈Ç`);
    showUpgradeButton(upgradeCost);
  }
}

function showUpgradeButton(cost) {
  let list = document.getElementById("upgradesList");
  let randomUpgrade = allUpgrades[Math.floor(Math.random() * allUpgrades.length)];

  let div = document.createElement("div");
  div.className = "upgrade";
  div.innerHTML = `
    <strong>${randomUpgrade.name}</strong><br>
    <em>${randomUpgrade.desc}</em><br>
    <button onclick="buyUpgrade('${randomUpgrade.effect}', ${cost}, this)">Kup (${cost} z≈Ç)</button>
  `;
  list.appendChild(div);
}

function buyUpgrade(effect, cost, button) {
  if (state.cash < cost) {
    log("‚ùå Za ma≈Ço got√≥wki na ulepszenie!");
    return;
  }
  state.cash -= cost;
  state.upgrades.push(effect);

  log(`‚úÖ Kupiono ulepszenie: ${effect}`);
  button.parentElement.remove();
  applyUpgrade(effect);
  updateUI();
}

function restartCustomerLoop() {
  if (customerInterval) clearInterval(customerInterval);

  // domy≈õlny czas pojawienia siƒô klienta = 10 sekund
  let baseTime = 10000;

  // spowolnienie od "Money Money"
  if (state.customerSlowdown) {
    baseTime *= (1 + state.customerSlowdown);
  }

  // przyspieszenie z innych upgrade'√≥w
  if (state.customerSpeedBonus) {
    baseTime *= (1 - state.customerSpeedBonus);
  }

  customerInterval = setInterval(() => {
    if (!customersPaused && Math.random() < 0.4) {
      addCustomer();
    }
  }, baseTime);
}

function applyUpgrade(effect, loading = false) {
  switch (effect) {
    case "customersFaster":
      state.customerSpeedBonus = (state.customerSpeedBonus || 0) + 0.03;
      restartCustomerLoop();
      break;

    case "moreMoney": // üí∞ Money Money
      state.moneyBonus = 1.2;          // +20% do ceny
      state.customerSlowdown = 0.05;   // klienci wolniej
      restartCustomerLoop();
      break;

    case "cheaperFood":
      state.moneyPenalty = 0.9;        // -10% ceny
      state.customerSpeedBonus = (state.customerSpeedBonus || 0) + 0.07; // szybciej
      restartCustomerLoop();
      break;
  }

  if (!loading) {
    log(`‚úÖ Kupiono ulepszenie: ${effect}`);
  }
}

function resetGame() {
  if (confirm("Czy na pewno chcesz zresetowaƒá grƒô? Wszystkie postƒôpy zostanƒÖ utracone.")) {
    localStorage.removeItem("restaurantGameSave");
    state = {
      cash: 200,
      ingredients: { banan: 0, bu≈Çka: 0, camembert: 0, chleb: 0, cukier: 0, cukier_puder: 0, cytryna: 0, czekolada: 0, jab≈Çko: 0, jajko: 0, kakao: 0, l√≥d: 0, mas≈Ço: 0, mas≈Ço_orzechowe: 0, mƒÖka: 0, migda≈Çy: 0, mleko: 0, par√≥wka: 0, pomidor: 0, ser_feta: 0, ser_mozzarella: 0, sos_czosnkowy: 0, sos_pomidorowy: 0, truskawka: 0, woda: 0, woda_gazowana: 0, wo≈Çowina: 0, ziemniak: 0 },
      level: 1,
      day: 1,
      servedToday: 0,
      dailyProfit: 0,
      dailyVisitors: [],
      upgrades: [],
      moneyBonus: 1,  
      moneyPenalty: 1, 
      customers: []
    };
    document.getElementById("customerList").innerHTML = "";
    log("Gra zosta≈Ça zresetowana.");
    updateUI();
  }
}

function addCustomer() {
  const customer = document.createElement("div");
  customer.className = "customer";

  // Wylosuj imiƒô
  let name;
  let attempts = 0;

  do {
    name = customerNames[Math.floor(Math.random() * customerNames.length)];
    attempts++;
    // zabezpieczenie, ≈ºeby nie zapƒôtli≈Ço siƒô, gdy wszyscy ju≈º byli
    if (attempts > customerNames.length) return; 
  } while (state.dailyVisitors.includes(name));

  // Dodaj do listy odwiedzajƒÖcych w tym dniu
  state.dailyVisitors.push(name);

  // Pobierz ulubione zam√≥wienie tej osoby
  const orders = favoriteOrders[name] ? [...favoriteOrders[name]] : ["Burger"];

  customer.dataset.orders = JSON.stringify(orders);

  // Wy≈õwietlamy zam√≥wienia klienta z imieniem
  customer.innerHTML = `üë§ <strong>${name}</strong> chce:<br><ul>${orders.map(d => `<li><strong>${d}</strong></li>`).join("")}</ul>` +
    `<button onclick="cookDish(this)">Ugotuj nastƒôpne danie</button>`;

  document.getElementById("customerList").appendChild(customer);
  state.customers.push(customer);
}

function cookDish(button) {
  const customer = button.parentElement;
  const orders = JSON.parse(customer.dataset.orders);

  if (orders.length === 0) {
    log("Klient nie ma ≈ºadnych zam√≥wie≈Ñ.");
    state.servedToday += 1;
    return;
  }

  const dishName = orders[0];
  const dish = dishes[dishName];

  // Sprawd≈∫ sk≈Çadniki
  for (const ingredient in dish.ingredients) {
    if ((state.ingredients[ingredient] || 0) < dish.ingredients[ingredient]) {
      log(`Za ma≈Ço sk≈Çadnik√≥w: ${ingredient}`);
      return;
    }
  }

  button.disabled = true;
  document.getElementById("cookProgress").style.display = "block";
  let bar = document.getElementById("cookBar");
  let progress = 0;
  let duration = 3000 / state.level;

  let interval = setInterval(() => {
    progress += 100 / (duration / 100);
    bar.style.width = progress + "%";
    if (progress >= 100) {
      clearInterval(interval);
      bar.style.width = "0%";
      document.getElementById("cookProgress").style.display = "none";

      // Po ugotowaniu dania odejmij sk≈Çadniki i kasƒô
      for (const ingredient in dish.ingredients) {
        state.ingredients[ingredient] -= dish.ingredients[ingredient];
      }
      
      const bonus = state.level;
      let basePrice = dish.price + bonus;
      let totalPrice = basePrice * state.moneyBonus * state.moneyPenalty;

      state.cash += Math.floor(totalPrice);
      state.dailyProfit += Math.floor(totalPrice);      

      // Usu≈Ñ ugotowane danie z listy zam√≥wie≈Ñ
      orders.shift();
      customer.dataset.orders = JSON.stringify(orders);

      log(`Podano ${dishName}. Zysk: ${dish.price} z≈Ç.`);
      
      if (Math.random() < 0.4) {
        let tip = Math.floor(Math.random() * 20) + state.level * 3;
        state.cash += tip;
        state.dailyProfit += tip;
        log(`üí∏ Klient ${customer.querySelector("strong").textContent} zostawi≈Ç napiwek: ${tip} z≈Ç`);
  }
  
      if (orders.length === 0) {
        state.servedToday += 1;
        customer.remove();
        state.customers = state.customers.filter(c => c !== customer);
        let stars = Math.floor(Math.random() * 2) + 4; // 4-5 gwiazdek
        let reviewTexts = [
         "Pyszne jedzenie, polecam!",
         "Szybka i mi≈Ça obs≈Çuga!",
         "Bardzo smaczne, wr√≥cƒô tu!",
         "Idealnie doprawione!",
         "Jedzenie przepyszne, jeszcze tu wr√≥cƒô!",   
         "Obs≈Çuga na medal, polecam ka≈ºdemu!",    
         "Smakowa eksplozja, a≈º chce siƒô wiƒôcej!"   
        ];
        let text = reviewTexts[Math.floor(Math.random() * reviewTexts.length)];
        addReview(stars, text);
      }

      if (orders.length === 0) {
        // Wszystkie dania ugotowane, klient zadowolony odchodzi
        state.servedToday += 1;
        customer.remove();
        state.customers = state.customers.filter(c => c !== customer);
      } else {
        // W≈ÇƒÖcz przycisk ponownie, ≈ºeby mo≈ºna by≈Ço ugotowaƒá nastƒôpne danie
        button.disabled = false;
        // Aktualizuj listƒô w UI
        customer.querySelector("ul").innerHTML = orders.map(d => `<li><strong>${d}</strong></li>`).join("");
      }
      updateUI();
    }
  }, 100);
}

function finishCooking(button, dishName) {
  const dish = dishes[dishName];
  for (const ingredient in dish.ingredients) {
    state.ingredients[ingredient] -= dish.ingredients[ingredient];
  }
  state.cash += dish.price;
  state.dailyProfit += dish.price;
  state.servedToday += 1;

  // usu≈Ñ klienta
  const customer = button.parentElement;
  customer.remove();

  // usu≈Ñ z tablicy klient√≥w
  state.customers = state.customers.filter(c => c !== customer);

  log(`Podano ${dishName}. Zysk: ${dish.price} z≈Ç.`);
  updateUI();
}

function customerLoop(extraSpeed = 0) {
  let baseChance = 0.4; 
  let finalChance = baseChance + extraSpeed - (state.customerSlowdown || 0);
  if (finalChance < 0.05) finalChance = 0.05; // nie mniej ni≈º 5%

  customerInterval = setInterval(() => {
    if (!customersPaused && Math.random() < finalChance) addCustomer();
  }, 10000);
}

function dayCycle() {
  dayInterval = setInterval(() => {
    if (!customersPaused) {
      state.day += 1;
      state.dailyProfit = 0;
      state.servedToday = 0;
      state.dailyVisitors = []; 
      log("üìÖ Nowy dzie≈Ñ: " + state.day);
      updateUI();
    }
  }, 60000);
}

function saveGame() {
  localStorage.setItem("restaurantState", JSON.stringify(state));
}

function loadGame() {
  const saved = localStorage.getItem("restaurantState");
  if (saved) {
    state = JSON.parse(saved);

    // üëá naprawa b≈Çƒôdu
    if (!state.upgrades) {
      state.upgrades = [];
    }

    // Przywracamy efekty kupionych ulepsze≈Ñ
    if (state.upgrades.length > 0) {
      state.upgrades.forEach(effect => {
        applyUpgrade(effect, true); // tryb loading
      });
    }
  } else {
    log("Nowa gra rozpoczƒôta.");
  }

  nextRewardTime = parseInt(localStorage.getItem("nextRewardTime")) || Date.now() + rewardInterval;
  startRewardTimer();

  updateUI();
}

/* Funkcja odbierania nagrody */
function claimReward() {
  let chance = Math.random();

  if (chance < 0.5) {
    // Nagroda: sk≈Çadnik
    let ingredients = Object.keys(ingredientPrices);
    let randomIngredient = ingredients[Math.floor(Math.random() * ingredients.length)];
    state.ingredients[randomIngredient] = (state.ingredients[randomIngredient] || 0) + 1;
    log(`üéÅ Otrzymano losowy sk≈Çadnik: ${randomIngredient}`);
  } else {
    // Nagroda: got√≥wka
    let cashReward = Math.floor(Math.random() * 196) + 5; // 5 - 200 z≈Ç
    state.cash += cashReward;
    log(`üéÅ Otrzymano ${cashReward} z≈Ç`);
  }

  nextRewardTime = Date.now() + rewardInterval;
  localStorage.setItem("nextRewardTime", nextRewardTime);

  document.getElementById("rewardButton").style.display = "none";
  startRewardTimer();
  updateUI();
}

/* Timer nagrody */
function startRewardTimer() {
  if (rewardTimerInterval) clearInterval(rewardTimerInterval);

  rewardTimerInterval = setInterval(() => {
    let now = Date.now();
    let remaining = nextRewardTime - now;

    if (remaining <= 0) {
      document.getElementById("rewardButton").style.display = "inline-block";
      document.getElementById("rewardTimer").textContent = "Nagroda dostƒôpna!";
      clearInterval(rewardTimerInterval);
    } else {
      let seconds = Math.floor(remaining / 1000);
      document.getElementById("rewardTimer").textContent = `‚è≥ Kolejna nagroda za ${seconds} sekund`;
    }
  }, 1000);
}

// Start
loadGame();
customerLoop();
dayCycle();

</script>

</body>
</html>
